<!DOCTYPE html>
<html>
<head>
    <title>Row Query Application</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:hover {background-color: #f5f5f5;}
    </style>
    <script type="text/javascript">
        var ws = new WebSocket("ws://fraud-app-route-tornado-app-demo.apps.b2s001.pbm.ihost.com/data");

        ws.onopen = function() {
            console.log('WebSocket has been opened!');
        };

        ws.onmessage = function(message) {
            var data = message.data;
            console.log('Received message:', data);
            if (data.startsWith('error: ')) {
                console.log('Displaying alert box with error message:', data.substring(7));
                alert(data.substring(7));
            } else {
                displayData(data);
            }
        };
    
        function sendRowQuery() {
            var numberOfRows = document.getElementById("rowInput").value;
            if (ws.readyState === WebSocket.OPEN) {
                ws.send(numberOfRows);
                document.getElementById("status").innerText = "Processing...";
                document.getElementById("resultTable").innerHTML = ""; // Clear previous results
            } else {
                console.log('Cannot send message, WebSocket is not open');
            }
        }
    
        function displayData(data) {
            var resultTable = document.getElementById("resultTable");
            var splitData = data.split(',tableName: ');
            var tableData = splitData[0];
            var tableName = splitData[1];
            resultTable.innerHTML += '<h2>' + tableName + '</h2>' + tableData; // Append the received HTML to the existing content of the resultTable element
            document.getElementById("status").innerText = "Data loaded.";
        }
    </script>
</head>
<body>
    <h1>Row Query Application</h1>
    <input type="number" id="rowInput" placeholder="Enter number of rows">
    <button onclick="sendRowQuery()">Enter</button>
    <div id="status">Status will be shown here.</div>
    <div id="resultTable"><!-- Table will be generated here --></div>
</body>
</html>
